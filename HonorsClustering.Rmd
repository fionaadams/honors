---
title: "HonorsClustering"
author: "Fiona Adams"
date: "9/26/2019"
output: html_document
---
Resources:
http://www.mjdenny.com/Text_Processing_In_R.html

```{r}
library(readr)
AndrewTuttle <- read_delim("AndrewTuttle.txt", 
    "^", escape_double = FALSE, trim_ws = TRUE, col_names=FALSE)
```

```{r}
library(stringr)
library(tidyverse)

#Clean Andrew Tuttle: sentence-level analysis
SCleanTuttle <- AndrewTuttle %>% 
  tolower() %>%
  str_replace_all("ms.", "miss") %>%
  str_split("\\. ") %>%
  as.data.frame()

colnames(SCleanTuttle)[1] <- "sentences"
SCleanTuttle$sentences <- as.character(SCleanTuttle$sentences)

#Clean Andrew Tuttle: word-level analysis
WCleanTuttle <- AndrewTuttle %>% 
  tolower() %>%
  str_replace_all("[^a-zA-Z\\s]", " ") %>% #Remove all punctuation 
  str_replace_all("[\\s]+", " ") %>% #Shrink to one white space
  str_extract_all("\\w{3,}") %>% #get rid of one or two letter words ex. i, or
  as.data.frame()
```

```{r} 
library(udpipe)
ud_model <- udpipe_download_model(language = "english")
udmodel_english <- udpipe_load_model(ud_model$file_model)

s <- udpipe_annotate(udmodel_english, SCleanTuttle$sentences)
x <- data.frame(s)
```

```{r}
#Nouns
nouns <- subset(x, upos %in% c("NOUN")) 
nouns <- txt_freq(nouns$token)
top25nouns <- head(nouns$key, 25)

#Adjectives
adjectives <- subset(x, upos %in% c("ADJ")) 
adjectives <- txt_freq(adjectives$token)
top25adjectives <- head(adjectives$key, 25)

#Noun-adjective phrases
phrases <- keywords_rake(x = x, term = "lemma", group = "doc_id", 
                       relevant = x$upos %in% c("NOUN", "ADJ"))
phrases$key <- factor(phrases$keyword, levels = rev(phrases$keyword))
top25phrases <- head(phrases$key, 25)

#Key phrases in general
#Figure out: how to take out one letter words from sentence-level analysis!
x$phrase_tag <- as_phrasemachine(x$upos, type = "upos")
stats <- keywords_phrases(x = x$phrase_tag, term = tolower(x$token), 
                          pattern = "(A|N)*N(P+D*(A|N)*N)*", 
                          is_regex = TRUE, detailed = FALSE)
stats <- subset(stats, ngram > 1 & freq > 3)
stats$key <- factor(stats$keyword, levels = rev(stats$keyword))
top25keyphrases <- head(stats$key, 25)
top25keyphrases
```

```{r}
#How to make a new column for each keyword, automatically??
#Can make a column indicating whether the sentence has a word, but not more than that
SCleanTuttle <- SCleanTuttle %>%
  mutate()
```




